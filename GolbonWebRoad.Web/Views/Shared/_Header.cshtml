@{
    // Check if user is authenticated to determine the account link
    bool isAuthenticated = User?.Identity?.IsAuthenticated ?? false;
}

<div class="promo-banner">
    <p>ارسال رایگان برای خریدهای بالای ۵۰۰ هزار تومان!</p>
</div>

<header class="main-header">
    <div class="container header-container">
        <a href="/" class="logo">Tecture</a>
        <nav class="main-nav">
            <ul>
                <li><a href="/"><i class="fa-solid fa-home"></i> خانه</a></li>
                <li><a href="#categories" onclick="scrollToSection('categories')"><i class="fa-solid fa-th-large"></i> دسته‌بندی‌ها</a></li>
                <li><a asp-controller="Products" asp-action="Index"><i class="fa-solid fa-box"></i> محصولات</a></li>
                <li><a href="#deal-of-the-day" onclick="scrollToSection('deal-of-the-day')"><i class="fa-solid fa-tags"></i> تخفیف‌ها</a></li>
                <li><a href="#blog" onclick="scrollToSection('blog')"><i class="fa-solid fa-newspaper"></i> بلاگ</a></li>
                <li><a asp-controller="Contactus" asp-action="Index"><i class="fa-solid fa-envelope"></i> تماس با ما</a></li>
            </ul>
        </nav>
        <div class="header-actions">
            <div id="theme-toggle">
                <i class="fas fa-moon"></i>
                <i class="fas fa-sun"></i>
            </div>
            @if (isAuthenticated)
            {
                <a asp-controller="Dashboard" asp-action="Index" class="header-action-link">
                    <i class="fa-solid fa-user"></i>
                    <span>حساب کاربری</span>
                </a>
            }
            else
            {
                <a asp-area="Identity" asp-page="/Account/Login" class="header-action-link">
                    <i class="fa-solid fa-user"></i>
                    <span>ورود / ثبت‌نام</span>
                </a>
            }
            <a asp-controller="Cart" asp-action="Index" class="header-action-link">
                <i class="fa-solid fa-shopping-bag"></i>
            </a>
            <i class="fa-solid fa-magnifying-glass"></i>
            <i class="fa-solid fa-bars mobile-menu-toggle" id="mobileMenuToggle"></i>
        </div>
    </div>
</header>

<!-- Mobile Menu -->
<div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>
<div class="mobile-menu" id="mobileMenu">
    <div class="mobile-menu-header">
        <span class="logo">Tecture</span>
        <i class="fa-solid fa-times mobile-menu-close" id="mobileMenuClose"></i>
    </div>
    <nav>
        <ul>
            <li><a href="/"><i class="fa-solid fa-home"></i> خانه</a></li>
            <li><a href="#categories" onclick="scrollToSection('categories'); closeMobileMenu();"><i class="fa-solid fa-th-large"></i> دسته‌بندی‌ها</a></li>
            <li><a asp-controller="Products" asp-action="Index"><i class="fa-solid fa-box"></i> محصولات</a></li>
            <li><a href="#deal-of-the-day" onclick="scrollToSection('deal-of-the-day'); closeMobileMenu();"><i class="fa-solid fa-tags"></i> تخفیف‌ها</a></li>
            <li><a href="#blog" onclick="scrollToSection('blog'); closeMobileMenu();"><i class="fa-solid fa-newspaper"></i> بلاگ</a></li>
            <li><a asp-controller="Contactus" asp-action="Index"><i class="fa-solid fa-envelope"></i> تماس با ما</a></li>
            @if (isAuthenticated)
            {
                <li><a asp-controller="Dashboard" asp-action="Index"><i class="fa-solid fa-user-circle"></i> حساب کاربری</a></li>
            }
            else
            {
                <li><a asp-area="Identity" asp-page="/Account/Login"><i class="fa-solid fa-sign-in-alt"></i> ورود / ثبت‌نام</a></li>
            }
            <li><a asp-controller="Cart" asp-action="Index"><i class="fa-solid fa-shopping-bag"></i> سبد خرید</a></li>
        </ul>
    </nav>
</div>

<script>
    // Mobile menu functionality
    (function() {
        const mobileMenuToggle = document.getElementById('mobileMenuToggle');
        const mobileMenu = document.getElementById('mobileMenu');
        const mobileMenuOverlay = document.getElementById('mobileMenuOverlay');
        const mobileMenuClose = document.getElementById('mobileMenuClose');
        
        if (mobileMenuToggle) {
            mobileMenuToggle.addEventListener('click', function() {
                mobileMenu.classList.add('active');
                mobileMenuOverlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            });
        }
        
        function closeMobileMenuFn() {
            mobileMenu.classList.remove('active');
            mobileMenuOverlay.classList.remove('active');
            document.body.style.overflow = '';
        }
        
        if (mobileMenuClose) {
            mobileMenuClose.addEventListener('click', closeMobileMenuFn);
        }
        
        if (mobileMenuOverlay) {
            mobileMenuOverlay.addEventListener('click', closeMobileMenuFn);
        }
        
        // Make closeMobileMenu available globally
        window.closeMobileMenu = closeMobileMenuFn;
    })();
    
    // Function to scroll to sections (for home page anchors)
    function scrollToSection(sectionId) {
        // Only work if we're on the home page
        if (window.location.pathname === '/' || window.location.pathname === '/Home' || window.location.pathname === '/Home/Index') {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
            }
        } else {
            // If not on home page, navigate to home page with anchor
            window.location.href = '/#' + sectionId;
        }
    }
</script>
